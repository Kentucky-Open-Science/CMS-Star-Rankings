<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CMS Hospital Star Ratings Calculator</title>
    <meta name="description" content="Calculate your hospital's CMS star rating based on quality measures">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <header class="header">
        <div class="header-content">
            <div class="logo">
                <div class="logo-icon">‚òÖ</div>
                <div class="logo-text">
                    <h1>Hospital STAR Ratings</h1>
                    <p>CMS Quality Calculator</p>
                </div>
            </div>
            <div class="header-controls">
                <div class="hospital-selector">
                    <div class="hospital-search-container">
                        <input type="text" id="hospital-search" placeholder="Search hospital..." autocomplete="off">
                        <div id="hospital-results" class="dropdown-list"></div>
                    </div>
                </div>
                <div class="measure-badge">July 2025 Methodology</div>
            </div>
        </div>
    </header>

    <main class="container">
        <section class="intro">
            <h2 id="hospital-name-heading">Calculate Your Hospital's Star Rating</h2>
            <p>Modify the values below to explore your hospital's star ranking, or use the search bar above to load a
                different medical center.</p>
        </section>

        <div class="main-grid">
            <div class="measures-form">
                <!-- Mortality Group -->
                <div class="card measure-section">
                    <div class="measure-header" onclick="toggleSection('mortality')">
                        <div class="measure-header-left">
                            <div class="measure-icon mortality">üíî</div>
                            <div class="measure-title">
                                <h3>Outcomes - Mortality</h3>
                                <p>7 measures ‚Ä¢ Weight: 22%</p>
                            </div>
                        </div>
                        <div class="measure-badge" id="mortality-count">0/7 entered</div>
                        <svg class="chevron" width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                            <path fill-rule="evenodd"
                                d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" />
                        </svg>
                    </div>
                    <div class="measure-content" id="mortality-content">
                        <div class="measure-grid">
                            <div class="input-group">
                                <label for="MORT_30_AMI">MORT_30_AMI</label>
                                <input type="number" step="any" id="MORT_30_AMI" name="MORT_30_AMI"
                                    placeholder="Enter rate">
                                <div class="input-hint">30-Day Mortality - Heart Attack</div>
                            </div>
                            <div class="input-group">
                                <label for="MORT_30_CABG">MORT_30_CABG</label>
                                <input type="number" step="any" id="MORT_30_CABG" name="MORT_30_CABG"
                                    placeholder="Enter rate">
                                <div class="input-hint">30-Day Mortality - CABG Surgery</div>
                            </div>
                            <div class="input-group">
                                <label for="MORT_30_COPD">MORT_30_COPD</label>
                                <input type="number" step="any" id="MORT_30_COPD" name="MORT_30_COPD"
                                    placeholder="Enter rate">
                                <div class="input-hint">30-Day Mortality - COPD</div>
                            </div>
                            <div class="input-group">
                                <label for="MORT_30_HF">MORT_30_HF</label>
                                <input type="number" step="any" id="MORT_30_HF" name="MORT_30_HF"
                                    placeholder="Enter rate">
                                <div class="input-hint">30-Day Mortality - Heart Failure</div>
                            </div>
                            <div class="input-group">
                                <label for="MORT_30_PN">MORT_30_PN</label>
                                <input type="number" step="any" id="MORT_30_PN" name="MORT_30_PN"
                                    placeholder="Enter rate">
                                <div class="input-hint">30-Day Mortality - Pneumonia</div>
                            </div>
                            <div class="input-group">
                                <label for="MORT_30_STK">MORT_30_STK</label>
                                <input type="number" step="any" id="MORT_30_STK" name="MORT_30_STK"
                                    placeholder="Enter rate">
                                <div class="input-hint">30-Day Mortality - Stroke</div>
                            </div>
                            <div class="input-group">
                                <label for="PSI_4_SURG_COMP">PSI_4_SURG_COMP</label>
                                <input type="number" step="any" id="PSI_4_SURG_COMP" name="PSI_4_SURG_COMP"
                                    placeholder="Enter rate">
                                <div class="input-hint">Death Rate Among Surgical Patients</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Safety Group -->
                <div class="card measure-section">
                    <div class="measure-header" onclick="toggleSection('safety')">
                        <div class="measure-header-left">
                            <div class="measure-icon safety">üõ°Ô∏è</div>
                            <div class="measure-title">
                                <h3>Outcomes - Safety of Care</h3>
                                <p>8 measures ‚Ä¢ Weight: 22%</p>
                            </div>
                        </div>
                        <div class="measure-badge" id="safety-count">0/8 entered</div>
                        <svg class="chevron" width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                            <path fill-rule="evenodd"
                                d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" />
                        </svg>
                    </div>
                    <div class="measure-content" id="safety-content">
                        <div class="measure-grid">
                            <div class="input-group">
                                <label for="COMP_HIP_KNEE">COMP_HIP_KNEE</label>
                                <input type="number" step="any" id="COMP_HIP_KNEE" name="COMP_HIP_KNEE"
                                    placeholder="Enter rate">
                                <div class="input-hint">Hip/Knee Complication Rate</div>
                            </div>
                            <div class="input-group">
                                <label for="HAI_1">HAI_1 (CLABSI)</label>
                                <input type="number" step="any" id="HAI_1" name="HAI_1" placeholder="Enter SIR">
                                <div class="input-hint">Central Line-Associated BSI</div>
                            </div>
                            <div class="input-group">
                                <label for="HAI_2">HAI_2 (CAUTI)</label>
                                <input type="number" step="any" id="HAI_2" name="HAI_2" placeholder="Enter SIR">
                                <div class="input-hint">Catheter-Associated UTI</div>
                            </div>
                            <div class="input-group">
                                <label for="HAI_3">HAI_3 (SSI Colon)</label>
                                <input type="number" step="any" id="HAI_3" name="HAI_3" placeholder="Enter SIR">
                                <div class="input-hint">SSI - Colon Surgery</div>
                            </div>
                            <div class="input-group">
                                <label for="HAI_4">HAI_4 (SSI Hysterectomy)</label>
                                <input type="number" step="any" id="HAI_4" name="HAI_4" placeholder="Enter SIR">
                                <div class="input-hint">SSI - Abdominal Hysterectomy</div>
                            </div>
                            <div class="input-group">
                                <label for="HAI_5">HAI_5 (MRSA)</label>
                                <input type="number" step="any" id="HAI_5" name="HAI_5" placeholder="Enter SIR">
                                <div class="input-hint">MRSA Bacteremia</div>
                            </div>
                            <div class="input-group">
                                <label for="HAI_6">HAI_6 (C.diff)</label>
                                <input type="number" step="any" id="HAI_6" name="HAI_6" placeholder="Enter SIR">
                                <div class="input-hint">C. difficile Infection</div>
                            </div>
                            <div class="input-group">
                                <label for="PSI_90_SAFETY">PSI_90_SAFETY</label>
                                <input type="number" step="any" id="PSI_90_SAFETY" name="PSI_90_SAFETY"
                                    placeholder="Enter rate">
                                <div class="input-hint">Patient Safety Composite</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Readmission Group -->
                <div class="card measure-section">
                    <div class="measure-header" onclick="toggleSection('readmission')">
                        <div class="measure-header-left">
                            <div class="measure-icon readmission">üîÑ</div>
                            <div class="measure-title">
                                <h3>Outcomes - Readmission</h3>
                                <p>11 measures ‚Ä¢ Weight: 22%</p>
                            </div>
                        </div>
                        <div class="measure-badge" id="readmission-count">0/11 entered</div>
                        <svg class="chevron" width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                            <path fill-rule="evenodd"
                                d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" />
                        </svg>
                    </div>
                    <div class="measure-content" id="readmission-content">
                        <div class="measure-grid">
                            <div class="input-group">
                                <label for="EDAC_30_AMI">EDAC_30_AMI</label>
                                <input type="number" step="any" id="EDAC_30_AMI" name="EDAC_30_AMI"
                                    placeholder="Enter rate">
                                <div class="input-hint">ED Visits After AMI Discharge</div>
                            </div>
                            <div class="input-group">
                                <label for="EDAC_30_HF">EDAC_30_HF</label>
                                <input type="number" step="any" id="EDAC_30_HF" name="EDAC_30_HF"
                                    placeholder="Enter rate">
                                <div class="input-hint">ED Visits After HF Discharge</div>
                            </div>
                            <div class="input-group">
                                <label for="EDAC_30_PN">EDAC_30_PN</label>
                                <input type="number" step="any" id="EDAC_30_PN" name="EDAC_30_PN"
                                    placeholder="Enter rate">
                                <div class="input-hint">ED Visits After PN Discharge</div>
                            </div>
                            <div class="input-group">
                                <label for="OP_32">OP_32</label>
                                <input type="number" step="any" id="OP_32" name="OP_32" placeholder="Enter rate">
                                <div class="input-hint">ED Returns - Colonoscopy</div>
                            </div>
                            <div class="input-group">
                                <label for="READM_30_CABG">READM_30_CABG</label>
                                <input type="number" step="any" id="READM_30_CABG" name="READM_30_CABG"
                                    placeholder="Enter rate">
                                <div class="input-hint">30-Day Readmission - CABG</div>
                            </div>
                            <div class="input-group">
                                <label for="READM_30_COPD">READM_30_COPD</label>
                                <input type="number" step="any" id="READM_30_COPD" name="READM_30_COPD"
                                    placeholder="Enter rate">
                                <div class="input-hint">30-Day Readmission - COPD</div>
                            </div>
                            <div class="input-group">
                                <label for="READM_30_HIP_KNEE">READM_30_HIP_KNEE</label>
                                <input type="number" step="any" id="READM_30_HIP_KNEE" name="READM_30_HIP_KNEE"
                                    placeholder="Enter rate">
                                <div class="input-hint">30-Day Readmission - Hip/Knee</div>
                            </div>
                            <div class="input-group">
                                <label for="READM_30_HOSP_WIDE">READM_30_HOSP_WIDE</label>
                                <input type="number" step="any" id="READM_30_HOSP_WIDE" name="READM_30_HOSP_WIDE"
                                    placeholder="Enter rate">
                                <div class="input-hint">Hospital-Wide Readmission</div>
                            </div>
                            <div class="input-group">
                                <label for="OP_35_ADM">OP_35_ADM</label>
                                <input type="number" step="any" id="OP_35_ADM" name="OP_35_ADM"
                                    placeholder="Enter rate">
                                <div class="input-hint">Admissions for ED Patients</div>
                            </div>
                            <div class="input-group">
                                <label for="OP_35_ED">OP_35_ED</label>
                                <input type="number" step="any" id="OP_35_ED" name="OP_35_ED" placeholder="Enter rate">
                                <div class="input-hint">ED Visits for ED Patients</div>
                            </div>
                            <div class="input-group">
                                <label for="OP_36">OP_36</label>
                                <input type="number" step="any" id="OP_36" name="OP_36" placeholder="Enter rate">
                                <div class="input-hint">Hospital Visits After Outpatient Surgery</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Patient Experience Group -->
                <div class="card measure-section">
                    <div class="measure-header" onclick="toggleSection('experience')">
                        <div class="measure-header-left">
                            <div class="measure-icon experience">üòä</div>
                            <div class="measure-title">
                                <h3>Patient Experience</h3>
                                <p>8 measures ‚Ä¢ Weight: 22%</p>
                            </div>
                        </div>
                        <div class="measure-badge" id="experience-count">0/8 entered</div>
                        <svg class="chevron" width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                            <path fill-rule="evenodd"
                                d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" />
                        </svg>
                    </div>
                    <div class="measure-content" id="experience-content">
                        <div class="measure-grid">
                            <div class="input-group">
                                <label for="H_COMP_1_STAR_RATING">H_COMP_1 - Communication with Nurses</label>
                                <input type="number" step="any" min="1" max="5" id="H_COMP_1_STAR_RATING"
                                    name="H_COMP_1_STAR_RATING" placeholder="1-5 star rating">
                                <div class="input-hint">HCAHPS Nurse Communication</div>
                            </div>
                            <div class="input-group">
                                <label for="H_COMP_2_STAR_RATING">H_COMP_2 - Communication with Doctors</label>
                                <input type="number" step="any" min="1" max="5" id="H_COMP_2_STAR_RATING"
                                    name="H_COMP_2_STAR_RATING" placeholder="1-5 star rating">
                                <div class="input-hint">HCAHPS Doctor Communication</div>
                            </div>
                            <div class="input-group">
                                <label for="H_COMP_3_STAR_RATING">H_COMP_3 - Staff Responsiveness</label>
                                <input type="number" step="any" min="1" max="5" id="H_COMP_3_STAR_RATING"
                                    name="H_COMP_3_STAR_RATING" placeholder="1-5 star rating">
                                <div class="input-hint">HCAHPS Staff Responsiveness</div>
                            </div>
                            <div class="input-group">
                                <label for="H_COMP_5_STAR_RATING">H_COMP_5 - Communication About Medicines</label>
                                <input type="number" step="any" min="1" max="5" id="H_COMP_5_STAR_RATING"
                                    name="H_COMP_5_STAR_RATING" placeholder="1-5 star rating">
                                <div class="input-hint">HCAHPS Medicine Communication</div>
                            </div>
                            <div class="input-group">
                                <label for="H_COMP_6_STAR_RATING">H_COMP_6 - Discharge Information</label>
                                <input type="number" step="any" min="1" max="5" id="H_COMP_6_STAR_RATING"
                                    name="H_COMP_6_STAR_RATING" placeholder="1-5 star rating">
                                <div class="input-hint">HCAHPS Discharge Info</div>
                            </div>
                            <div class="input-group">
                                <label for="H_COMP_7_STAR_RATING">H_COMP_7 - Care Transition</label>
                                <input type="number" step="any" min="1" max="5" id="H_COMP_7_STAR_RATING"
                                    name="H_COMP_7_STAR_RATING" placeholder="1-5 star rating">
                                <div class="input-hint">HCAHPS Care Transition</div>
                            </div>
                            <div class="input-group">
                                <label for="H_GLOB_STAR_RATING">H_GLOB - Overall Rating</label>
                                <input type="number" step="any" min="1" max="5" id="H_GLOB_STAR_RATING"
                                    name="H_GLOB_STAR_RATING" placeholder="1-5 star rating">
                                <div class="input-hint">HCAHPS Overall Rating</div>
                            </div>
                            <div class="input-group">
                                <label for="H_INDI_STAR_RATING">H_INDI - Recommend Hospital</label>
                                <input type="number" step="any" min="1" max="5" id="H_INDI_STAR_RATING"
                                    name="H_INDI_STAR_RATING" placeholder="1-5 star rating">
                                <div class="input-hint">HCAHPS Recommend</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Timely & Effective Care Group -->
                <div class="card measure-section">
                    <div class="measure-header" onclick="toggleSection('care')">
                        <div class="measure-header-left">
                            <div class="measure-icon care">‚è±Ô∏è</div>
                            <div class="measure-title">
                                <h3>Timely and Effective Care</h3>
                                <p>12 measures ‚Ä¢ Weight: 12%</p>
                            </div>
                        </div>
                        <div class="measure-badge" id="care-count">0/12 entered</div>
                        <svg class="chevron" width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                            <path fill-rule="evenodd"
                                d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" />
                        </svg>
                    </div>
                    <div class="measure-content" id="care-content">
                        <div class="measure-grid">
                            <div class="input-group">
                                <label for="HCP_COVID_19">HCP_COVID_19</label>
                                <input type="number" step="any" id="HCP_COVID_19" name="HCP_COVID_19"
                                    placeholder="Enter rate">
                                <div class="input-hint">COVID-19 Vaccination Coverage</div>
                            </div>
                            <div class="input-group">
                                <label for="IMM_3">IMM_3</label>
                                <input type="number" step="any" id="IMM_3" name="IMM_3" placeholder="Enter rate">
                                <div class="input-hint">Influenza Immunization</div>
                            </div>
                            <div class="input-group">
                                <label for="OP_10">OP_10</label>
                                <input type="number" step="any" id="OP_10" name="OP_10" placeholder="Enter minutes">
                                <div class="input-hint">Abdomen CT Use of Contrast</div>
                            </div>
                            <div class="input-group">
                                <label for="OP_13">OP_13</label>
                                <input type="number" step="any" id="OP_13" name="OP_13" placeholder="Enter rate">
                                <div class="input-hint">Cardiac Imaging for Low-Risk Patients</div>
                            </div>
                            <div class="input-group">
                                <label for="OP_18B">OP_18B</label>
                                <input type="number" step="any" id="OP_18B" name="OP_18B" placeholder="Enter minutes">
                                <div class="input-hint">ED Median Time to Transfer</div>
                            </div>
                            <div class="input-group">
                                <label for="OP_22">OP_22</label>
                                <input type="number" step="any" id="OP_22" name="OP_22" placeholder="Enter ratio">
                                <div class="input-hint">Left Without Being Seen</div>
                            </div>
                            <div class="input-group">
                                <label for="OP_23">OP_23</label>
                                <input type="number" step="any" id="OP_23" name="OP_23" placeholder="Enter rate">
                                <div class="input-hint">ED Head CT Results</div>
                            </div>
                            <div class="input-group">
                                <label for="OP_29">OP_29</label>
                                <input type="number" step="any" id="OP_29" name="OP_29" placeholder="Enter rate">
                                <div class="input-hint">Colonoscopy Follow-Up</div>
                            </div>
                            <div class="input-group">
                                <label for="OP_8">OP_8</label>
                                <input type="number" step="any" id="OP_8" name="OP_8" placeholder="Enter rate">
                                <div class="input-hint">MRI Lumbar Spine for Low Back Pain</div>
                            </div>
                            <div class="input-group">
                                <label for="PC_01">PC_01</label>
                                <input type="number" step="any" id="PC_01" name="PC_01" placeholder="Enter rate">
                                <div class="input-hint">Elective Delivery</div>
                            </div>
                            <div class="input-group">
                                <label for="SAFE_USE_OF_OPIOIDS">SAFE_USE_OF_OPIOIDS</label>
                                <input type="number" step="any" id="SAFE_USE_OF_OPIOIDS" name="SAFE_USE_OF_OPIOIDS"
                                    placeholder="Enter rate">
                                <div class="input-hint">Safe Use of Opioids</div>
                            </div>
                            <div class="input-group">
                                <label for="SEP_1">SEP_1</label>
                                <input type="number" step="any" id="SEP_1" name="SEP_1" placeholder="Enter rate">
                                <div class="input-hint">Severe Sepsis Bundle</div>
                            </div>
                        </div>
                    </div>
                </div>

                <button type="button" class="calculate-btn" onclick="calculateRating()">
                    Calculate Star Rating
                </button>

                <!-- Optimization Configuration -->
                <div class="optimization-section-wrapper disabled" id="optimization-wrapper">
                    <div class="optimization-overlay" id="optimization-overlay">
                        <div class="optimization-overlay-content">
                            <div class="lock-icon">üîí</div>
                            <p>Select a hospital to enable optimization</p>
                        </div>
                    </div>
                    <div class="card measure-section"
                        style="margin-top: 2rem; border-top: 4px solid var(--accent-gold);">
                        <div class="measure-header" onclick="toggleSection('optimization-config')">
                            <div class="measure-header-left">
                                <div class="measure-icon"
                                    style="background: linear-gradient(135deg, #7c3aed, #5b21b6);">üöÄ
                                </div>
                                <div class="measure-title">
                                    <h3>Optimization Configuration</h3>
                                    <p>Target rating, budget, and measure costs</p>
                                </div>
                            </div>
                            <svg class="chevron" width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                                <path fill-rule="evenodd"
                                    d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" />
                            </svg>
                        </div>

                        <div class="measure-content expanded" id="optimization-config-content">
                            <div style="padding: 1.5rem;">

                                <!-- Goal & Budget -->
                                <div
                                    style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; margin-bottom: 2rem;">
                                    <div>
                                        <label
                                            style="display: block; color: var(--text-secondary); font-size: 0.75rem; font-weight: 500; margin-bottom: 0.5rem;">OPTIMIZATION
                                            GOAL</label>

                                        <div style="display: flex; flex-direction: column; gap: 0.5rem;">
                                            <label
                                                style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer; color: var(--text-primary);">
                                                <input type="radio" name="target_mode" value="next_star" checked
                                                    onchange="toggleTargetScoreInput()">
                                                Reach Next Star Rating
                                            </label>
                                            <label
                                                style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer; color: var(--text-primary);">
                                                <input type="radio" name="target_mode" value="specific_score"
                                                    onchange="toggleTargetScoreInput()">
                                                Target Specific Score
                                            </label>
                                        </div>

                                        <div id="target-score-container"
                                            style="margin-top: 0.5rem; display: none; padding-left: 1.5rem;">
                                            <input type="number" step="0.01" id="target_score"
                                                placeholder="Enter target (e.g. -0.25)"
                                                style="background: rgba(0,0,0,0.3); border: 1px solid var(--card-border); color: white; padding: 0.5rem; border-radius: 6px; width: 100%;">
                                        </div>
                                    </div>

                                    <div>
                                        <label for="budget-input"
                                            style="display: block; color: var(--text-secondary); font-size: 0.75rem; font-weight: 500; margin-bottom: 0.5rem;">TOTAL
                                            BUDGET ($)</label>
                                        <input type="number" id="budget-input" value="1000000" step="100000"
                                            style="width: 100%; background: rgba(0,0,0,0.3); border: 1px solid var(--card-border); color: white; padding: 0.75rem; border-radius: 8px; font-size: 1rem;">
                                    </div>
                                </div>

                                <!-- Actionable Measures -->
                                <div style="margin-bottom: 2rem;">
                                    <div
                                        style="display: flex; justify-content: space-between; align-items: flex-end; margin-bottom: 0.5rem;">
                                        <label
                                            style="color: var(--text-secondary); font-size: 0.75rem; font-weight: 500;">ACTIONABLE
                                            MEASURES</label>
                                        <button class="load-btn-sm" onclick="toggleAll('actionable', true)"
                                            style="font-size: 0.7rem;">Select All</button>
                                    </div>
                                    <div
                                        style="background: rgba(0,0,0,0.2); border: 1px solid var(--card-border); border-radius: 8px; overflow: visible;">
                                        <table style="width: 100%; font-size: 0.85rem; border-collapse: collapse;">
                                            <thead
                                                style="background: rgba(255,255,255,0.05); color: var(--text-secondary);">
                                                <tr>
                                                    <th style="padding: 0.75rem; text-align: left; width: 40px;"></th>
                                                    <th style="padding: 0.75rem; text-align: left;">Measure</th>
                                                    <th style="padding: 0.75rem; text-align: right; width: 150px;">Cost
                                                        per
                                                        0.1 SD ($)</th>
                                                </tr>
                                            </thead>
                                            <tbody id="opt-actionable-tbody">
                                                <!-- Steps will be populated by JS -->
                                            </tbody>
                                        </table>
                                    </div>
                                </div>

                                <!-- Other Measures -->
                                <div>
                                    <div
                                        style="display: flex; justify-content: space-between; align-items: flex-end; margin-bottom: 0.5rem;">
                                        <label
                                            style="color: var(--text-secondary); font-size: 0.75rem; font-weight: 500;">OTHER
                                            MEASURES</label>
                                        <button class="load-btn-sm" onclick="toggleTable('opt-other-tbody')"
                                            id="btn-toggle-other">Show/Hide</button>
                                    </div>
                                    <div style="background: rgba(0,0,0,0.2); border: 1px solid var(--card-border); border-radius: 8px; overflow: visible; display: none;"
                                        id="opt-other-container">
                                        <table style="width: 100%; font-size: 0.85rem; border-collapse: collapse;">
                                            <thead
                                                style="background: rgba(255,255,255,0.05); color: var(--text-secondary);">
                                                <tr>
                                                    <th style="padding: 0.75rem; text-align: left; width: 40px;"></th>
                                                    <th style="padding: 0.75rem; text-align: left;">Measure</th>
                                                    <th style="padding: 0.75rem; text-align: right; width: 150px;">Cost
                                                        per
                                                        0.1 SD ($)</th>
                                                </tr>
                                            </thead>
                                            <tbody id="opt-other-tbody">
                                                <!-- Steps will be populated by JS -->
                                            </tbody>
                                        </table>
                                    </div>
                                </div>

                                <button type="button" id="btn-optimize" class="calculate-btn" onclick="optimizeRating()"
                                    disabled
                                    style="background: linear-gradient(135deg, #7c3aed, #5b21b6); margin-top: 2rem; opacity: 0.5; cursor: not-allowed;">
                                    Run Optimization
                                </button>
                            </div>
                        </div>
                    </div>
                </div> <!-- Close optimization-section-wrapper -->
            </div>

            <!-- Results Panel -->
            <div class="results-panel">
                <div class="card results-card">
                    <div class="results-header">
                        <h3>Your Star Rating</h3>
                        <p>Based on CMS July 2025 Methodology</p>
                    </div>

                    <div class="star-display">
                        <div class="stars-container" id="stars-container">
                            <span class="star" id="star-1">‚òÖ</span>
                            <span class="star" id="star-2">‚òÖ</span>
                            <span class="star" id="star-3">‚òÖ</span>
                            <span class="star" id="star-4">‚òÖ</span>
                            <span class="star" id="star-5">‚òÖ</span>
                        </div>
                        <div class="star-label pending" id="star-label">Enter measures to calculate</div>
                    </div>

                    <div class="eligibility" id="eligibility-section">
                        <div class="eligibility-header">
                            <span class="eligibility-status pending" id="eligibility-status">‚è≥ Awaiting
                                Input</span>
                        </div>
                        <div class="eligibility-details" id="eligibility-details">
                            Enter at least 3 measures in 3 different groups, including Mortality or Safety.
                        </div>
                    </div>

                    <div class="group-scores" id="group-scores-section">
                        <h4>Group Scores</h4>
                        <div class="score-item">
                            <div class="score-label">
                                <span>Mortality</span>
                                <span id="mortality-score">--</span>
                            </div>
                            <div class="score-bar">
                                <div class="score-fill" id="mortality-bar" style="width: 0%"></div>
                            </div>
                        </div>
                        <div class="score-item">
                            <div class="score-label">
                                <span>Safety</span>
                                <span id="safety-score">--</span>
                            </div>
                            <div class="score-bar">
                                <div class="score-fill" id="safety-bar" style="width: 0%"></div>
                            </div>
                        </div>
                        <div class="score-item">
                            <div class="score-label">
                                <span>Readmission</span>
                                <span id="readmission-score">--</span>
                            </div>
                            <div class="score-bar">
                                <div class="score-fill" id="readmission-bar" style="width: 0%"></div>
                            </div>
                        </div>
                        <div class="score-item">
                            <div class="score-label">
                                <span>Patient Experience</span>
                                <span id="experience-score">--</span>
                            </div>
                            <div class="score-bar">
                                <div class="score-fill" id="experience-bar" style="width: 0%"></div>
                            </div>
                        </div>
                        <div class="score-item">
                            <div class="score-label">
                                <span>Timely & Effective Care</span>
                                <span id="care-score">--</span>
                            </div>
                            <div class="score-bar">
                                <div class="score-fill" id="care-bar" style="width: 0%"></div>
                            </div>
                        </div>
                    </div>

                    <div class="summary-score">
                        <h4>Summary Score</h4>
                        <div class="summary-value" id="summary-score">--</div>
                    </div>

                    <div class="footnote">
                        This calculator replicates the official CMS methodology from the July 2025 SAS program
                        package.
                        Results are estimates based on standardized measure scores.
                    </div>
                </div>
            </div>
        </div>

        <!-- Hospital Ratings List Section -->
        <section class="top-hospitals-section">
            <div class="section-header">
                <h2>Hospital Ratings List</h2>
                <p>Browse hospitals by star rating and load their data.</p>
            </div>

            <div class="card table-card">
                <div class="table-controls"
                    style="display: flex; justify-content: space-between; align-items: center; padding: 1rem; border-bottom: 1px solid #e5e7eb;">
                    <div class="filter-group">
                        <label for="rating-filter"
                            style="font-weight: 500; margin-right: 0.5rem; color: #6b7280;">Filter by
                            Rating:</label>
                        <select id="rating-filter"
                            style="padding: 0.5rem; border-radius: 0.375rem; border: 1px solid #d1d5db;">
                            <option value="">All Ratings</option>
                            <option value="5" selected>5 Stars</option>
                            <option value="4">4 Stars</option>
                            <option value="3">3 Stars</option>
                            <option value="2">2 Stars</option>
                            <option value="1">1 Star</option>
                        </select>
                    </div>
                    <div class="pagination-info" id="pagination-info" style="color: #6b7280; font-size: 0.875rem;">
                        Page 1
                    </div>
                </div>

                <div class="table-container">
                    <table class="hospitals-table">
                        <thead>
                            <tr>
                                <th>Hospital Name</th>
                                <th>Rating</th>
                                <th style="text-align: right;">Action</th>
                            </tr>
                        </thead>
                        <tbody id="top-hospitals-body">
                            <!-- Populated by JS -->
                            <tr>
                                <td colspan="3" class="loading-row">Loading hospitals...</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="pagination-controls"
                    style="display: flex; justify-content: space-between; padding: 1rem; border-top: 1px solid #e5e7eb;">
                    <button id="prev-btn" class="secondary-btn" disabled
                        style="padding: 0.5rem 1rem; border: 1px solid #d1d5db; border-radius: 0.375rem; background: white; cursor: pointer;">Previous</button>
                    <button id="next-btn" class="secondary-btn"
                        style="padding: 0.5rem 1rem; border: 1px solid #d1d5db; border-radius: 0.375rem; background: white; cursor: pointer;">Next</button>
                </div>
            </div>
        </section>
    </main>


    <!-- Optimization Results Modal -->
    <div id="optimization-modal" class="modal"
        style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 1000; justify-content: center; align-items: center; backdrop-filter: blur(5px);">
        <div class="modal-content"
            style="background: #0f172a; padding: 2rem; border-radius: 1rem; max-width: 800px; width: 90%; max-height: 90vh; overflow-y: auto; box-shadow: 0 20px 50px rgba(0,0,0,0.5); border: 1px solid rgba(255,255,255,0.1);">
            <div
                style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem; border-bottom: 1px solid rgba(255,255,255,0.1); padding-bottom: 1rem;">
                <h2 style="margin: 0; color: #fff;">Optimization Proposal</h2>
                <button onclick="closeModal()"
                    style="background: none; border: none; font-size: 2rem; cursor: pointer; color: #9ca3af;">&times;</button>
            </div>

            <div id="optimization-loading" style="text-align: center; padding: 3rem;">
                <div class="spinner" style="margin: 0 auto 1.5rem;"></div>
                <p style="color: #cbd5e1;">Running Optuna optimization process...</p>
                <p style="font-size: 0.8rem; color: #64748b;">This may take a few seconds</p>
            </div>

            <div id="optimization-results" style="display: none;">
                <div
                    style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem; margin-bottom: 2rem; background: rgba(255,255,255,0.05); padding: 1.5rem; border-radius: 0.5rem; border: 1px solid rgba(255,255,255,0.05);">
                    <div style="text-align: center;">
                        <h4
                            style="color: #94a3b8; margin-bottom: 0.5rem; text-transform: uppercase; font-size: 0.8rem; letter-spacing: 0.05em;">
                            Current Status</h4>
                        <div style="font-size: 2rem; font-weight: bold; color: #fff;" id="opt-current-stars">-- Stars
                        </div>
                        <div style="color: #cbd5e1; font-family: monospace;" id="opt-current-score">Score: --</div>
                    </div>
                    <div style="text-align: center; border-left: 1px solid rgba(255,255,255,0.1);">
                        <h4
                            style="color: #a78bfa; margin-bottom: 0.5rem; text-transform: uppercase; font-size: 0.8rem; letter-spacing: 0.05em;">
                            Projected Status</h4>
                        <div style="font-size: 2rem; font-weight: bold; color: #a78bfa;" id="opt-projected-stars">--
                            Stars</div>
                        <div style="color: #ddd6fe; font-family: monospace;" id="opt-projected-score">Score: --</div>
                    </div>
                </div>

                <div style="display: flex; justify-content: space-between; align-items: flex-end; margin-bottom: 1rem;">
                    <h3 style="color: #fff; font-size: 1.1rem;">Recommended Actions</h3>
                    <div style="text-align: right;">
                        <span style="display: block; font-size: 0.75rem; color: #94a3b8;">Total Est. Cost</span>
                        <span id="opt-total-cost"
                            style="font-weight: bold; color: #ef4444; font-size: 1.1rem;">--</span>
                    </div>
                </div>

                <div class="table-container"
                    style="max-height: 300px; overflow-y: auto; border: 1px solid rgba(255,255,255,0.1); border-radius: 8px;">
                    <table class="hospitals-table" style="width: 100%;">
                        <thead style="position: sticky; top: 0; background: #0f172a; z-index: 10;">
                            <tr>
                                <th>Measure</th>
                                <th>Action</th>
                                <th style="text-align: right;">Cost</th>
                            </tr>
                        </thead>
                        <tbody id="recommendations-body">
                            <!-- Items -->
                        </tbody>
                    </table>
                </div>

                <div style="margin-top: 2rem; text-align: right;">
                    <button onclick="applyOptimization()" class="calculate-btn"
                        style="width: auto; padding: 0.75rem 2rem; font-size: 0.9rem; margin-top: 0; display: inline-block;">Apply
                        to Form</button>
                    <button onclick="closeModal()"
                        style="background: none; border: 1px solid rgba(255,255,255,0.2); color: #fff; padding: 0.75rem 1.5rem; border-radius: 12px; cursor: pointer; margin-left: 0.5rem;">Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Select Hospital First Modal -->
    <div id="select-hospital-modal" class="select-hospital-modal">
        <div class="select-hospital-modal-content">
            <div class="modal-icon">üè•</div>
            <h3>Select a Hospital First</h3>
            <p>Please search for and select a hospital from the dropdown above, or click "Load Data" on any hospital in
                the list below to begin.</p>
            <button class="modal-btn" onclick="closeSelectHospitalModal()">Got It</button>
        </div>
    </div>

    <!-- Onboarding Overlay -->
    <div id="onboarding-overlay" class="onboarding-overlay">
        <div class="onboarding-backdrop"></div>

        <!-- Step 1: Search bar -->
        <div class="onboarding-step" id="onboarding-step-1">
            <div class="onboarding-pointer onboarding-pointer-search">
                <div class="onboarding-arrow onboarding-arrow-up"></div>
                <div class="onboarding-tooltip onboarding-tooltip-step">
                    <div class="onboarding-tooltip-icon">üîç</div>
                    <div class="onboarding-tooltip-content">
                        <h4>Search for a Hospital</h4>
                        <p>Type a hospital name or ID to quickly find and load its data.</p>
                    </div>
                    <div class="onboarding-tooltip-actions">
                        <span class="onboarding-step-indicator">Step 1 of 5</span>
                        <button class="onboarding-next-btn" onclick="goToOnboardingStep(2)">Next ‚Üí</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Step 2: Hospital list -->
        <div class="onboarding-step" id="onboarding-step-2" style="display: none;">
            <div class="onboarding-pointer onboarding-pointer-list-fixed">
                <div class="onboarding-tooltip onboarding-tooltip-step">
                    <div class="onboarding-tooltip-icon">üìã</div>
                    <div class="onboarding-tooltip-content">
                        <h4>Browse Hospital List</h4>
                        <p>Select a hospital and click "Load Data" to load its measures. Once loaded, the tour will
                            continue.</p>
                    </div>
                    <div class="onboarding-tooltip-actions">
                        <span class="onboarding-step-indicator">Step 2 of 5</span>
                        <button class="onboarding-done-btn" onclick="dismissOnboardingForHospitalSelect()">Got
                            It</button>
                    </div>
                </div>
                <div class="onboarding-arrow onboarding-arrow-down"></div>
            </div>
        </div>

        <!-- Step 3: Measure sections (shown after hospital loads) -->
        <div class="onboarding-step" id="onboarding-step-3" style="display: none;">
            <div class="onboarding-pointer onboarding-pointer-measures">
                <div class="onboarding-tooltip onboarding-tooltip-step onboarding-tooltip-wide">
                    <div class="onboarding-tooltip-icon">üìä</div>
                    <div class="onboarding-tooltip-content">
                        <h4>Modify Measure Values</h4>
                        <p>Click any section header to expand it. You can edit the measure values to see how changes
                            affect your star rating. Each group contributes a weighted score.</p>
                    </div>
                    <div class="onboarding-tooltip-actions">
                        <span class="onboarding-step-indicator">Step 3 of 5</span>
                        <button class="onboarding-next-btn" onclick="goToOnboardingStep(4)">Next ‚Üí</button>
                    </div>
                </div>
                <div class="onboarding-arrow onboarding-arrow-down"></div>
            </div>
        </div>

        <!-- Step 4: Calculate button -->
        <div class="onboarding-step" id="onboarding-step-4" style="display: none;">
            <div class="onboarding-pointer onboarding-pointer-calculate">
                <div class="onboarding-tooltip onboarding-tooltip-step">
                    <div class="onboarding-tooltip-icon">‚≠ê</div>
                    <div class="onboarding-tooltip-content">
                        <h4>Calculate Star Rating</h4>
                        <p>After modifying measures, click this button to recalculate. View your results in the panel on
                            the right showing group scores and overall rating.</p>
                    </div>
                    <div class="onboarding-tooltip-actions">
                        <span class="onboarding-step-indicator">Step 4 of 5</span>
                        <button class="onboarding-next-btn" onclick="goToOnboardingStep(5)">Next ‚Üí</button>
                    </div>
                </div>
                <div class="onboarding-arrow onboarding-arrow-down"></div>
            </div>
        </div>

        <!-- Step 5: Optimization section -->
        <div class="onboarding-step" id="onboarding-step-5" style="display: none;">
            <div class="onboarding-pointer onboarding-pointer-optimization">
                <div class="onboarding-tooltip onboarding-tooltip-step onboarding-tooltip-wide">
                    <div class="onboarding-tooltip-icon">üöÄ</div>
                    <div class="onboarding-tooltip-content">
                        <h4>Optimization Tools</h4>
                        <p><strong>Goal:</strong> Choose to reach the next star rating or target a specific score.<br>
                            <strong>Budget:</strong> Set your total improvement budget.<br>
                            <strong>Measures:</strong> Check which measures to optimize and set cost per
                            improvement.<br>
                            Click "Run Optimization" to get recommendations!
                        </p>
                    </div>
                    <div class="onboarding-tooltip-actions">
                        <label class="onboarding-checkbox-inline">
                            <input type="checkbox" id="onboarding-dont-show">
                            <span>Don't show again</span>
                        </label>
                        <button class="onboarding-done-btn" onclick="dismissOnboarding()">Finish Tour</button>
                    </div>
                </div>
                <div class="onboarding-arrow onboarding-arrow-up"></div>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>

</html>